<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:DocsUnmessed.GUI.ViewModels"
             x:Class="DocsUnmessed.GUI.Views.DashboardPage"
             x:DataType="vm:DashboardViewModel"
             Title="Dashboard">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Welcome Section -->
            <Frame BackgroundColor="#512BD4" Padding="30" CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="{Binding WelcomeMessage}" 
                           TextColor="White" 
                           FontSize="28" 
                           FontAttributes="Bold"/>
                    <Label Text="Your file organization assistant" 
                           TextColor="White" 
                           FontSize="16"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Statistics Cards -->
            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="15">
                <!-- Total Scans -->
                <Frame Grid.Column="0" Padding="20" CornerRadius="10" BackgroundColor="#F0F0F0">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="📊" FontSize="32" HorizontalOptions="Center"/>
                        <Label Text="{Binding TotalScans}" 
                               FontSize="32" 
                               FontAttributes="Bold" 
                               HorizontalOptions="Center"/>
                        <Label Text="Total Scans" 
                               FontSize="14" 
                               HorizontalOptions="Center"
                               TextColor="Gray"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Total Files -->
                <Frame Grid.Column="1" Padding="20" CornerRadius="10" BackgroundColor="#F0F0F0">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="📁" FontSize="32" HorizontalOptions="Center"/>
                        <Label Text="{Binding TotalFiles}" 
                               FontSize="32" 
                               FontAttributes="Bold" 
                               HorizontalOptions="Center"/>
                        <Label Text="Total Files" 
                               FontSize="14" 
                               HorizontalOptions="Center"
                               TextColor="Gray"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Total Size -->
                <Frame Grid.Column="2" Padding="20" CornerRadius="10" BackgroundColor="#F0F0F0">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="💾" FontSize="32" HorizontalOptions="Center"/>
                        <Label Text="{Binding TotalSize}" 
                               FontSize="32" 
                               FontAttributes="Bold" 
                               HorizontalOptions="Center"/>
                        <Label Text="Total Size" 
                               FontSize="14" 
                               HorizontalOptions="Center"
                               TextColor="Gray"/>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Quick Actions -->
            <Label Text="Quick Actions" FontSize="22" FontAttributes="Bold" Margin="0,10,0,0"/>
            
            <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                <Button Grid.Column="0" 
                        Text="📂 Assess Files" 
                        Command="{Binding NavigateToAssessCommand}"
                        BackgroundColor="#28a745"
                        TextColor="White"
                        FontSize="16"
                        HeightRequest="80"
                        CornerRadius="10"/>
                
                <Button Grid.Column="1" 
                        Text="🚀 Migrate Files" 
                        Command="{Binding NavigateToMigrationCommand}"
                        BackgroundColor="#007bff"
                        TextColor="White"
                        FontSize="16"
                        HeightRequest="80"
                        CornerRadius="10"/>
            </Grid>

            <!-- Recent Scans -->
            <Label Text="Recent Scans" FontSize="22" FontAttributes="Bold" Margin="0,10,0,0"/>
            
            <Frame Padding="15" CornerRadius="10" BackgroundColor="#F9F9F9">
                <CollectionView ItemsSource="{Binding RecentScans}">
                    <CollectionView.EmptyView>
                        <Label Text="No recent scans. Start by assessing your files!" 
                               TextColor="Gray" 
                               HorizontalOptions="Center"
                               Margin="20"/>
                    </CollectionView.EmptyView>
                    
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="0,5" Padding="15" BackgroundColor="White" CornerRadius="8">
                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="15">
                                    <Label Grid.Column="0" Text="📊" FontSize="24" VerticalOptions="Center"/>
                                    <VerticalStackLayout Grid.Column="1" Spacing="5">
                                        <Label Text="{Binding ScanId}" FontSize="14" FontAttributes="Bold"/>
                                        <Label Text="{Binding Date, StringFormat='{0:yyyy-MM-dd HH:mm}'}" 
                                               FontSize="12" 
                                               TextColor="Gray"/>
                                    </VerticalStackLayout>
                                    <VerticalStackLayout Grid.Column="2" Spacing="5">
                                        <Label Text="{Binding FileCount}" FontSize="14" HorizontalOptions="End"/>
                                        <Label Text="{Binding Size}" FontSize="12" TextColor="Gray" HorizontalOptions="End"/>
                                    </VerticalStackLayout>
                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Frame>

            <!-- Loading Indicator -->
            <ActivityIndicator IsRunning="{Binding IsLoading}" IsVisible="{Binding IsLoading}"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
